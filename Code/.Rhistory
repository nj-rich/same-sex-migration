left_join(count_samesex_from_old_legal, by = "year") %>%
left_join(subtracted_trends_post, by = "year") %>%
left_join(count_samesex_migrants_from_old_legal, by = "year") %>%
left_join(mean_income_samesex, by = "year") %>%
left_join(subtracted_trends_ante, by = "year")
gc()
#subtracted exante trends table
subtracted_trends_ante <- count_samesex_migrants_from_old_legal %>%
mutate(subtracted_trends_post = `Same-Sex Migrants from Old Legal` - `Opposite-Sex Migrants from Old Legal`) %>%
select(subtracted_trends_ante)
gc()
#subtracted exante trends table
subtracted_trends_ante <- count_samesex_migrants_from_old_legal %>%
mutate(subtracted_trends_ante = `Same-Sex Migrants from Old Legal` - `Opposite-Sex Migrants from Old Legal`) %>%
select(subtracted_trends_ante)
gc()
#subtracted expost trends table
subtracted_trends_post <- count_samesex_migrants_in_old_legal %>%
mutate(subtracted_trends_post = `Same-Sex Migrants in Old Legal` - `Opposite-Sex Migrants in Old Legal`) %>%
select(year, subtracted_trends_post)
gc()
#subtracted exante trends table
subtracted_trends_ante <- count_samesex_migrants_from_old_legal %>%
mutate(subtracted_trends_ante = `Same-Sex Migrants from Old Legal` - `Opposite-Sex Migrants from Old Legal`) %>%
select(year, subtracted_trends_ante)
gc()
#create joint table
joint_control_table <- count_samesex_in_old_legal %>%
left_join(count_samesex_migrants_in_old_legal, by = "year") %>%
left_join(count_samesex_from_old_legal, by = "year") %>%
left_join(subtracted_trends_post, by = "year") %>%
left_join(count_samesex_migrants_from_old_legal, by = "year") %>%
left_join(mean_income_samesex, by = "year") %>%
left_join(subtracted_trends_ante, by = "year")
joint_differences_table <- count_samesex_in_old_legal %>%
left_join(count_samesex_migrants_in_old_legal, by = "year") %>%
left_join(count_samesex_from_old_legal, by = "year") %>%
left_join(subtracted_trends_post, by = "year") %>%
left_join(count_samesex_migrants_from_old_legal, by = "year") %>%
left_join(mean_income_samesex, by = "year") %>%
left_join(subtracted_trends_ante, by = "year")
View(joint_differences_table)
gc()
#count prop by same_sex in post_old_legal state/not (with old_legal definition):
count_samesex_in_old_legal <- summary_stats %>%
group_by(year, in_samesex) %>%
summarize(prop_in_old_legal = survey_mean(expost_old_legal, na.rm = T)) %>%
select(-prop_in_old_legal_se) %>%
mutate(in_samesex = ifelse(in_samesex == 1, "Same-Sex in Old Legal", "Opposite-Sex in Old Legal")) %>%
pivot_wider(names_from = in_samesex, values_from = prop_in_old_legal)
gc()
#count prop migrants by same_sex in post_old_legal state/not (with old_legal definition):
count_samesex_migrants_in_old_legal <- summary_stats %>%
filter(migrant == 1) %>%
group_by(year, in_samesex) %>%
summarize(prop_in_old_legal = survey_mean(expost_old_legal, na.rm = T)) %>%
select(-prop_in_old_legal_se) %>%
mutate(in_samesex = ifelse(in_samesex == 1, "Same-Sex Migrants in Old Legal", "Opposite-Sex Migrants in Old Legal")) %>%
pivot_wider(names_from = in_samesex, values_from = prop_in_old_legal)
gc()
#subtracted expost trends table
subtracted_trends_post <- count_samesex_migrants_in_old_legal %>%
mutate(subtracted_trends_post = `Same-Sex Migrants in Old Legal` - `Opposite-Sex Migrants in Old Legal`) %>%
select(year, subtracted_trends_post)
gc()
#count prop by same_sex from post_old_legal state/not (with old_legal definition):
count_samesex_from_old_legal <- summary_stats %>%
group_by(year, in_samesex) %>%
summarize(prop_from_old_legal = survey_mean(exante_old_legal, na.rm = T)) %>%
select(-prop_from_old_legal_se) %>%
mutate(in_samesex = ifelse(in_samesex == 1, "Same-Sex from Old Legal", "Opposite-Sex from Old Legal")) %>%
pivot_wider(names_from = in_samesex, values_from = prop_from_old_legal)
gc()
#count prop migrants by same_sex in post_old_legal state/not (with old_legal definition):
count_samesex_migrants_from_old_legal <- summary_stats %>%
filter(migrant == 1) %>%
group_by(year, in_samesex) %>%
summarize(prop_from_old_legal = survey_mean(exante_old_legal, na.rm = T)) %>%
select(-prop_from_old_legal_se) %>%
mutate(in_samesex = ifelse(in_samesex == 1, "Same-Sex Migrants from Old Legal", "Opposite-Sex Migrants from Old Legal")) %>%
pivot_wider(names_from = in_samesex, values_from = prop_from_old_legal)
gc()
#subtracted exante trends table
subtracted_trends_ante <- count_samesex_migrants_from_old_legal %>%
mutate(subtracted_trends_ante = `Same-Sex Migrants from Old Legal` - `Opposite-Sex Migrants from Old Legal`) %>%
select(year, subtracted_trends_ante)
gc()
#create joint table
joint_differences_table <- count_samesex_in_old_legal %>%
left_join(count_samesex_from_old_legal, by = "year") %>%
left_join(subtracted_trends_post, by = "year") %>%
left_join(count_samesex_migrants_from_old_legal, by = "year") %>%
left_join(mean_income_samesex, by = "year") %>%
left_join(subtracted_trends_ante, by = "year") %>%
setNames(c("Year", "Same-Sex", "Opposite-Sex", "Same-Sex", "Opposite-Sex", "Difference", "Same-Sex", "Opposite-Sex", "Same-Sex", "Opposite-Sex", "Difference")) %>% #needs work
kable(caption = "Summary Statistics for Migration Decisions", format = "latex", booktabs = T, digits = 3) %>%
add_header_above(c(" " = 1, "Fraction in States Legal Before 2015" = 2, "Migrants in States Legal Before 2015" = 2, " " = 1, "Fraction from States Legal Before 2015" = 2, "Migrants from States Legal Before 2015" = 2, " " = 1))
#export joint table
writeLines(joint_control_table, "/Users/njrich/Desktop/same-sex-migration/outputs/summary_stats/differences_table.tex") #NOTE: THIS IS FOR MAC, WILL NEED TO ADJUST FOR WINDOWS
#export joint table
writeLines(joint_differences_table, "/Users/njrich/Desktop/same-sex-migration/outputs/summary_stats/differences_table.tex") #NOTE: THIS IS FOR MAC, WILL NEED TO ADJUST FOR WINDOWS
gc()
#create joint table
joint_differences_table <- count_samesex_in_old_legal %>%
left_join(count_samesex_migrants_in_old_legal, by = "year") %>%
left_join(subtracted_trends_post, by = "year") %>%
left_join(count_samesex_from_old_legal, by = "year") %>%
left_join(count_samesex_migrants_from_old_legal, by = "year") %>%
left_join(subtracted_trends_ante, by = "year") %>%
setNames(c("Year", "Same-Sex", "Opposite-Sex", "Same-Sex", "Opposite-Sex", "Difference", "Same-Sex", "Opposite-Sex", "Same-Sex", "Opposite-Sex", "Difference")) %>% #needs work
kable(caption = "Summary Statistics for Migration Decisions", format = "latex", booktabs = T, digits = 3) %>%
add_header_above(c(" " = 1, "Fraction in States Legal Before 2015" = 2, "Migrants in States Legal Before 2015" = 2, " " = 1, "Fraction from States Legal Before 2015" = 2, "Migrants from States Legal Before 2015" = 2, " " = 1))
#export joint table
writeLines(joint_differences_table, "/Users/njrich/Desktop/same-sex-migration/outputs/summary_stats/differences_table.tex") #NOTE: THIS IS FOR MAC, WILL NEED TO ADJUST FOR WINDOWS
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year")
View(post_migrant_trends)
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
ggplot(aes(x = year)) +
geom_line(aes(y = `Same-Sex Migrants from Old Legal`, color = `Same-Sex Migrants from Old Legal`)) +
geom_line(aes(y = `Opposite-Sex Migrants from Old Legal`, color = `Opposite-Sex Migrants from Old Legal`))
+
scale_x_binned() +
labs(title = "Migration of Same-Sex Individuals to Various States",
x = "Year",
y = "Fraction to State Type",
color = "Destination State") #watch clarifications needed here
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
ggplot(aes(x = year)) +
geom_line(aes(y = `Same-Sex Migrants from Old Legal`, color = `Same-Sex Migrants from Old Legal`)) +
geom_line(aes(y = `Opposite-Sex Migrants from Old Legal`, color = `Opposite-Sex Migrants from Old Legal`))
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
ggplot(aes(x = year)) +
geom_line(aes(y = `Same-Sex Migrants from Old Legal`, color = `Same-Sex Migrants from Old Legal`))
+
scale_x_binned() +
labs(title = "Migration of Same-Sex Individuals to Various States",
x = "Year",
y = "Fraction to State Type",
color = "Destination State") #watch clarifications needed here
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
ggplot(aes(x = year)) +
geom_line(aes(y = `Same-Sex Migrants from Old Legal`))
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
ggplot(aes(x = year)) +
geom_line(aes(y = `Same-Sex Migrants from Old Legal`)) +
geom_line(aes(y = `Opposite-Sex Migrants from Old Legal`))
+
scale_x_binned() +
labs(title = "Migration of Same-Sex Individuals to Various States",
x = "Year",
y = "Fraction to State Type",
color = "Destination State") #watch clarifications needed here
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
ggplot(aes(x = year)) +
geom_line(aes(y = `Same-Sex Migrants from Old Legal`)) +
geom_line(aes(y = `Opposite-Sex Migrants from Old Legal`))
#    +
#    scale_x_binned() +
#    labs(title = "Migration of Same-Sex Individuals to Various States",
#         x = "Year",
#         y = "Fraction to State Type",
#         color = "Destination State") #watch clarifications needed here
post_migrant_trends
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year")
View(post_migrant_trends)
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot(aes(x = year)) +
geom_line(aes(y = same_mig)) +
geom_line(aes(y = opp_mig))
#    +
#    scale_x_binned() +
#    labs(title = "Migration of Same-Sex Individuals to Various States",
#         x = "Year",
#         y = "Fraction to State Type",
#         color = "Destination State") #watch clarifications needed here
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot(aes(x = year)) +
geom_line(aes(y = same_mig), color = "red") +
geom_line(aes(y = opp_mig), color = "blue")  +
scale_x_binned() +
labs(title = "Migration of Same-Sex Individuals to Various States",
x = "Year",
y = "Fraction to State Type",
color = "Destination State") #watch clarifications needed here
post_migrant_trends
knitr::opts_chunk$set(echo = TRUE)
gc()
library(data.table) #for data loading
library(tidyverse) #for data work
install.packages("janitor")
library(janitor) #for clean_names
install.packages("srvyr")
library(srvyr) #for weighting
library(haven) #for reading in dta
install.packages("kableExtra") #to make more complicated output tables for LATEX
library(kableExtra)
install.packages("kableExtra")
gc()
#windows
# clean_df <- read_dta("C:\\Users\\njrich\\Downloads\\clean_dataframe.dta") %>%
#   clean_names()
#mac
clean_df <- read_dta("/Users/njrich/Downloads/clean_dataframe.dta") %>%
clean_names()
gc()
summary_stats <- as_survey(clean_df, weights = perwt) #note: exclude rep_wts so standard errors are inaccurate (file otherwise insanely big- talk someone about it)
#oop count labeling not super accurate
gc()
#count prop by same_sex in post_old_legal state/not (with old_legal definition):
count_samesex_in_old_legal <- summary_stats %>%
group_by(year, in_samesex) %>%
summarize(prop_in_old_legal = survey_mean(expost_old_legal, na.rm = T)) %>%
select(-prop_in_old_legal_se) %>%
mutate(in_samesex = ifelse(in_samesex == 1, "Same-Sex in Old Legal", "Opposite-Sex in Old Legal")) %>%
pivot_wider(names_from = in_samesex, values_from = prop_in_old_legal)
gc()
#count prop migrants by same_sex in post_old_legal state/not (with old_legal definition):
count_samesex_migrants_in_old_legal <- summary_stats %>%
filter(migrant == 1) %>%
group_by(year, in_samesex) %>%
summarize(prop_in_old_legal = survey_mean(expost_old_legal, na.rm = T)) %>%
select(-prop_in_old_legal_se) %>%
mutate(in_samesex = ifelse(in_samesex == 1, "Same-Sex Migrants in Old Legal", "Opposite-Sex Migrants in Old Legal")) %>%
pivot_wider(names_from = in_samesex, values_from = prop_in_old_legal)
gc()
#subtracted expost trends table
subtracted_trends_post <- count_samesex_migrants_in_old_legal %>%
mutate(subtracted_trends_post = `Same-Sex Migrants in Old Legal` - `Opposite-Sex Migrants in Old Legal`) %>%
select(year, subtracted_trends_post)
gc()
#count prop by same_sex from post_old_legal state/not (with old_legal definition):
count_samesex_from_old_legal <- summary_stats %>%
group_by(year, in_samesex) %>%
summarize(prop_from_old_legal = survey_mean(exante_old_legal, na.rm = T)) %>%
select(-prop_from_old_legal_se) %>%
mutate(in_samesex = ifelse(in_samesex == 1, "Same-Sex from Old Legal", "Opposite-Sex from Old Legal")) %>%
pivot_wider(names_from = in_samesex, values_from = prop_from_old_legal)
gc()
#count prop migrants by same_sex in post_old_legal state/not (with old_legal definition):
count_samesex_migrants_from_old_legal <- summary_stats %>%
filter(migrant == 1) %>%
group_by(year, in_samesex) %>%
summarize(prop_from_old_legal = survey_mean(exante_old_legal, na.rm = T)) %>%
select(-prop_from_old_legal_se) %>%
mutate(in_samesex = ifelse(in_samesex == 1, "Same-Sex Migrants from Old Legal", "Opposite-Sex Migrants from Old Legal")) %>%
pivot_wider(names_from = in_samesex, values_from = prop_from_old_legal)
gc()
#subtracted exante trends table
subtracted_trends_ante <- count_samesex_migrants_from_old_legal %>%
mutate(subtracted_trends_ante = `Same-Sex Migrants from Old Legal` - `Opposite-Sex Migrants from Old Legal`) %>%
select(year, subtracted_trends_ante)
gc()
#create joint table
joint_differences_table <- count_samesex_in_old_legal %>%
left_join(count_samesex_migrants_in_old_legal, by = "year") %>%
left_join(subtracted_trends_post, by = "year") %>%
left_join(count_samesex_from_old_legal, by = "year") %>%
left_join(count_samesex_migrants_from_old_legal, by = "year") %>%
left_join(subtracted_trends_ante, by = "year") %>%
setNames(c("Year", "Same-Sex", "Opposite-Sex", "Same-Sex", "Opposite-Sex", "Difference", "Same-Sex", "Opposite-Sex", "Same-Sex", "Opposite-Sex", "Difference")) %>% #needs work
kable(caption = "Summary Statistics for Migration Decisions", format = "latex", booktabs = T, digits = 3) %>%
add_header_above(c(" " = 1, "Fraction in States Legal Before 2015" = 2, "Migrants in States Legal Before 2015" = 2, " " = 1, "Fraction from States Legal Before 2015" = 2, "Migrants from States Legal Before 2015" = 2, " " = 1))
#export joint table
writeLines(joint_differences_table, "/Users/njrich/Desktop/same-sex-migration/outputs/summary_stats/differences_table.tex") #NOTE: THIS IS FOR MAC, WILL NEED TO ADJUST FOR WINDOWS
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot(aes(x = year)) +
geom_line(aes(y = same_mig), color = "red") +
geom_line(aes(y = opp_mig), color = "blue")  +
scale_x_binned() +
labs(title = "Migration of Same-Sex Individuals to Various States",
x = "Year",
y = "Fraction to State Type",
color = "Destination State") #watch clarifications needed here
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot(aes(x = year)) +
geom_line(aes(y = same_mig), color = "red") +
geom_line(aes(y = opp_mig), color = "blue")  +
scale_x_binned() +
labs(title = "Migration of Same-Sex Individuals to Various States",
x = "Year",
y = "Fraction to State Type",
color = "Destination State") #watch clarifications needed here
post_migrant_trends
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot(aes(x = year)) +
geom_line(aes(y = same_mig), color = "red") +
geom_line(aes(y = opp_mig), color = "blue")  +
scale_x_binned() +
labs(title = "Migration of Same-Sex Individuals to Various States",
x = "Year",
y = "Fraction to State Type",
color = "Destination State") #watch clarifications needed here
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year")
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot(aes(x = year)) +
geom_line(aes(y = same_mig), color = "red") +
geom_line(aes(y = opp_mig), color = "blue")
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot(aes(x = year)) +
geom_line(aes(y = same_mig), color = "red") +
geom_line(aes(y = opp_mig), color = "blue")  +
scale_x_binned() +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality")
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot(aes(x = year)) +
geom_point(aes(y = same_mig), color = "red") +
geom_point(aes(y = opp_mig), color = "blue")  +
scale_x_binned() +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year")
View(post_migrant_trends)
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot(aes(x = year)) +
geom_point(aes(y = same_mig), color = "red") +
geom_point(aes(y = opp_mig), color = "blue")  +
scale_x_binned() +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted"))
View(post_migrant_trends)
glimpse(post_migrant_trends)
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot(aes(x = year)) +
geom_point(aes(y = same_mig), color = "blue") +
geom_point(aes(y = opp_mig), color = "red")  +
scale_x_binned() +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
factor(year) %>%
ggplot(aes(x = year)) +
geom_point(aes(y = same_mig), color = "blue") +
geom_point(aes(y = opp_mig), color = "red")  +
scale_x_binned() +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot(aes(x = year)) +
geom_point(aes(y = same_mig), color = "blue") +
geom_point(aes(y = opp_mig), color = "red")  +
scale_x_binned() +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
ggplot() +
geom_point(aes(x = year, y = same_mig), color = "blue") +
geom_point(aes(x = year, y = opp_mig), color = "red")  +
scale_x_binned() +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
post_migrant_trends
#why are things lining up so weirdly??
#hmm incorporate migration decision in here too? use overall pop?
post_migrant_trends
?as_factor
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
mutate(year = factor(year)) %>%
ggplot() +
geom_point(aes(x = year, y = same_mig), color = "blue") +
geom_point(aes(x = year, y = opp_mig), color = "red")  +
scale_x_binned() +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
mutate(year = factor(year)) %>%
ggplot() +
geom_point(aes(x = year, y = same_mig), color = "blue") +
geom_point(aes(x = year, y = opp_mig), color = "red")  +
#    scale_x_binned() +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
post_migrant_trends
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
mutate(year = factor(year)) %>%
ggplot() +
geom_line(aes(x = year, y = same_mig), color = "blue") +
geom_line(aes(x = year, y = opp_mig), color = "red")  +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
mutate(year = factor(year)) %>%
ggplot() +
geom_point(aes(x = year, y = same_mig), color = "blue") +
geom_point(aes(x = year, y = opp_mig), color = "red")  +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
mutate(year = factor(year)) %>%
ggplot() +
geom_path(aes(x = year, y = same_mig), color = "blue") +
geom_point(aes(x = year, y = opp_mig), color = "red")  +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
post_migrant_trends
gc()
post_migrant_trends <- count_samesex_migrants_in_old_legal %>%
left_join(subtracted_trends_post, by = "year") %>%
setNames(c("year", "opp_mig", "same_mig", "subtracted")) %>%
mutate(year = factor(year)) %>%
ggplot() +
geom_line(aes(x = year, y = same_mig), color = "blue") +
geom_point(aes(x = year, y = opp_mig), color = "red")  +
labs(title = "Fraction of Migrants to States That Legalized Same-Sex Marriage Before 2015",
x = "Year",
y = "Fraction",
color = "Sexuality") #watch clarifications needed here
post_migrant_trends
